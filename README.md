# Практическое пособие по библиотеке requests языка программирования Python

## Оглавление
1. [Введение](#практическое-пособие-по-библиотеке-requests-языка-программирования-python)
2. [Оглавление](#оглавление)
3. [Что такое HTTP](#что-такое-протокол-http)
4. [Анатомия HTTP пакета](#анатомия-http-пакета)

## Что такое протокол HTTP

**HTTP (Hyper Text Transfer Protocol)** – или протокол передачи гипертекста. Представляет собой протокол прикладного уровня модели **OSI**, предназначен для передачи данных в формате гипертекста между клиентом (браузером) и сервером, что хранит набор гипертекстовых документов

### История протокола HTTP
![Страница текстового браузера Line Mode c поддержкой HTTP/0.9](https://optional.is/required/wp-content/uploads/2013/09/lmb.jpg )  
_Страница браузера Line Mode_


Первая версия данного протокола была представлена [Джоном Бернерсом-Ли](https://ru.wikipedia.org/wiki/%D0%91%D0%B5%D1%80%D0%BD%D0%B5%D1%80%D1%81-%D0%9B%D0%B8,_%D0%A2%D0%B8%D0%BC) и его командой в 1991 году. Протокол использовался для получения
гипертекстовых документов с удаленных серверов, и на момент выхода версии **HTTP/0.9** поддерживал лишь базовый функционал, такой как:
 
- Передача текстовых документов с дальнейшим отображением в окне терминала 

- Использование единичного TCP-соединения для передачи данных

- Поддержка единственного на тот момент **HTTP** метода — **GET**

Как можно догадаться, первая версия данного протокола хорошо справлялась с решением простых задач, однако для внедрения более продвинутых функций,
к примеру передачи изображений и аудиозаписей, нуждалась в серьезной доработке, в том числе изменении ряда фундаментальных аспектов практической
реализации протокола

#### HTTP/1.0
С выпуском версии 1.0 в 1996 году, протокол HTTP постепенно начал отходить от концепции простой передачи текстовой информации, а также претерпел значительные
изменения по сравнению с первой реализацией протокола, среди нововведений можно выделить:
  
  - Добавление в структуру пакета полей заголовка (**User-Agent**, **Content-Type**, **Content-Length**, **Date** и т.д)
  - Введение системы статус-кодов (**200**, **404**, **500**, ...)
  - Добавление методов **POST** и **HEAD**
  - Поддержка MIME-типов т.е CSS, JS, и мультимедиа (аудио, изображения, и т.д)

Однако несмотря на ряд обширных, и без сомнений прорывных для 1996 года изменений, **HTTP/1.0** сохранил ряд низкоуровневых проблем о некоторых из которых уже было упомянуто ранее, к примеру:
  - Cоздание нового TCP-соединения при каждом обращении к серверу
  - **Head-of-Line-Blocking (HOLB)** – или остановка передачи данных в случае ошибки передачи одного из сегментов

Из этого можно заключить, что версия 1.0 протокола HTTP была революционной для своего времени, а также ввела ряд фундаментальных концепций протокола HTTP, однако все также содержала проблемы связанные с использованием синхронной передачи данных через протокол TCP, и производительностью на стороне как клиента, так и сервера

#### HTTP/1.1

## Анатомия HTTP пакета
Перед тем как перейти к описанию структуры HTTP пакета, стоит разобраться в правилах, по которым в протоколе HTTP происходит обмен данными между хостами. HTTP — протокол построенный на базе клиент-серверной архитектуры, из чего закономерно следует, что передача данных в данном протоколе происходит посредством обмена двумя HTTP сообщениями:

 - **Request** — запрос от клиента к серверу
 
 - **Response** — ответ сервера на запрос клиента

Как было сказано в разделе [История протокола HTTP](#история-протокола-http), начиная с версии **HTTP/2** сообщения данного протокола передаются в формате бинарных сообщений, однако при декодировании т.е переводе в текстовый формат, обыкновенно выглядят следующим образом:

• Пример простейшего **GET** запроса
```http
GET /page HTTP/2
Host: site.com
User-Agent: python-requests/2.32
Accept: text/html
Accept-Language: en-US
Accept-Encoding: gzip, deflate
Connection: keep-alive
 ```

• Ответ на **GET** запрос
```http
HTTP/2 200 OK
Date: Mon, 16 Jun 2025 03:56:24 GMT
Server: nginx/1.29.0
Content-Type: text/html charset=UTF-8
Content-Length: 150
Connection: close

<html>
 <head>
  <title>Page title</title>
 </head>
 <body>
  Body
 </body>
</html>
```

Выше был приведен пример простейшего **GET** запроса, и ответа на него ввиде лаконичного **HTML** документа, однако содержание **HTTP** сообщений, наверняка вызвало ряд вопросов, поэтому стоит подробнее рассмотреть их структуру


### Структура **GET** запроса
- **Начальная строка HTTP запроса, содержит ключевую информацию пакета т.е страницу**
   - **GET** – обозначает метод **HTTP** запроса, распожен в начале пакета
   - **/page** – путь до страницы, которую запрашивает клиент
   - **HTTP/2** – версия протокола **HTTP** на стороне клиента
```http
GET /page HTTP/2
```
- **Заголовки HTTP запроса**
  - **Host** – заголовок для указания доменного имени или IP-адреса к которому обращается клиенту
  - **User-Agent** – заголовок для указания ПО (и, или) устройства с помощью которого был сделан запрос, помогает адаптировать ответ в зависимости от платформы пользователя
  - **Accept** – данный заголовок указывает допустимый формат для передачи данных в ответе на запрос
  - **Accept-Language** – заголовок, сообщающий серверу о языке, на котором клиент предпочитает получить ответ
  - **Accept-Encoding** – заголовок, необязательный к применению. Содержит данные о алгоритме сжатия, который поддерживает клиент. В нашем примере, сервер вернет ответ сжатый с помощью алгоритма [Deflate](https://ru.wikipedia.org/wiki/Deflate) 
  - **Connection** – заголовок для хранения информации о состоянии подключения, к примеру в нашем примере используется **keep-alive**
```http
Host: site.com
User-Agent: python-requests/2.32
Accept: text/html
Accept-Language: ru-RU
Accept-Encoding: gzip, deflate
Connection: keep-alive
```


### Структура ответа на **GET** запрос
- **Начальная строка HTTP ответа**
  - **HTTP/2** – версия протокола **HTTP** на стороне сервера
  - **200** – Статус-код **HTTP** ответа, при успешной передаче запрошенных данных равен **200**
```http
HTTP/2 200 OK
```
- **Заголовки HTTP ответа**
  - **Date** – заголовок хранящий дату и время отправки ответа на сторону клиента
  - **Server** – содержит информацию о сервере, который обрабатывал запрос клиента в нашем примере это **Nginx** версии **1.29.0**
  - **Content-Type** – заголовок используемый для хранения информации о формате данных в ответе, а также кодировке тела **HTTP** ответа
  - **Content-Length** – содержит данные о количестве байт в теле **HTTP** ответа 
  - **Connection** – как было обозначено выше, данный заголовок отображает текущее состояние подключения, в случае если данный заголовок имеет значение **close**, соединение считается закрытым 
```http
Date: Mon, 16 Jun 2025 03:56:24 GMT
Server: nginx/1.29.0
Content-Type: text/html charset=UTF-8
Content-Length: 75
Connection: close
```
- **Тело (Body) HTTP ответа в формате HTML (с одним отступом между заголовками и телом)**
```html
<html>
  <head>
   <title>Page title</title>
  </head>
  <body>
    Body 
  </body>
</html>
```
### Итоги
В данном разделе мы рассмотрели алгоритм, по которому происходит передача данных через протокол **HTTP**, а также cтруктуру **HTTP** пакетов с типами **Request** и **Response**. Также стоит помнишь, что выше был приведен лишь простейший пример, и в зависимости от потребностей, а также версии протокола **HTTP** пакет может содержать дополнительные заголовки, а правила форматирования пакета могут быть различны. Для полноценного ознакомления с данными правилами, стоит ознакомится с спецификацией [RFC-9113](https://datatracker.ietf.org/doc/html/rfc9113), а также спецификациями прочих версий данного протокола
